/* Autogenerated: 'src/ExtractionOCaml/bedrock2_solinas_reduction' --lang bedrock2 --static --no-wide-int --widen-carry --widen-bytes --split-multiret --no-select --no-field-element-typedefs curve25519_solinas 64 '2^255 - 19' mulmod */
/* curve description: curve25519_solinas */
/* machine_wordsize = 64 (from "64") */
/* requested operations: mulmod */
/* s-c = 2^255 - [(1, 19)] (from "2^255 - 19") */
/*  */
/* Computed values: */
/*  */

#include <stdint.h>
#include <string.h>

static __attribute__((always_inline)) inline uintptr_t
_br2_mulhuu(uintptr_t a, uintptr_t b) {
#if (UINTPTR_MAX == (1LLU<<31) - 1 + (1LLU<<31))
	return ((uint64_t)a * b) >> 32;
#elif (UINTPTR_MAX == (1LLU<<63) - 1 + (1LLU<<63))
	return ((__uint128_t)a * b) >> 64;
#else
#error "32-bit or 64-bit uintptr_t required"
#endif
}

// We use memcpy to work around -fstrict-aliasing.
// A plain memcpy is enough on clang 10, but not on gcc 10, which fails
// to infer the bounds on an integer loaded by memcpy.
// Adding a range mask after memcpy in turn makes slower code in clang.
// Loading individual bytes, shifting them together, and or-ing is fast
// on clang and sometimes on GCC, but other times GCC inlines individual
// byte operations without reconstructing wider accesses.
// The little-endian idiom below seems fast in gcc 9+ and clang 10.
static __attribute__((always_inline)) inline uintptr_t
_br2_load(uintptr_t a, uintptr_t sz) {
  switch (sz) {
  case 1: { uint8_t  r = 0; memcpy(&r, (void*)a, 1); return r; }
  case 2: { uint16_t r = 0; memcpy(&r, (void*)a, 2); return r; }
  case 4: { uint32_t r = 0; memcpy(&r, (void*)a, 4); return r; }
  case 8: { uint64_t r = 0; memcpy(&r, (void*)a, 8); return r; }
  default: __builtin_unreachable();
  }
}

static __attribute__((always_inline)) inline void
_br2_store(uintptr_t a, uintptr_t v, uintptr_t sz) {
  memcpy((void*)a, &v, sz);
}


/*
 * Input Bounds:
 *   in0: [[0x0 ~> 0xffffffffffffffff], [0x0 ~> 0xffffffffffffffff], [0x0 ~> 0xffffffffffffffff], [0x0 ~> 0xffffffffffffffff]]
 *   in1: [[0x0 ~> 0xffffffffffffffff], [0x0 ~> 0xffffffffffffffff], [0x0 ~> 0xffffffffffffffff], [0x0 ~> 0xffffffffffffffff]]
 * Output Bounds:
 *   out0: [[0x0 ~> 0xffffffffffffffff], [0x0 ~> 0xffffffffffffffff], [0x0 ~> 0xffffffffffffffff], [0x0 ~> 0xffffffffffffffff]]
 */
static
void internal_fiat_curve25519_solinas_mulmod(uintptr_t out0, uintptr_t in0, uintptr_t in1) {
  uintptr_t x3, x2, x1, x7, x6, x5, x0, x4, x14, x35, x41, x33, x42, x12, x43, x45, x46, x25, x20, x40, x49, x44, x50, x15, x51, x53, x54, x47, x56, x17, x22, x37, x59, x48, x60, x23, x61, x63, x64, x52, x65, x18, x66, x68, x69, x55, x70, x10, x71, x73, x74, x57, x76, x9, x28, x58, x79, x62, x80, x26, x81, x83, x84, x67, x85, x21, x86, x88, x89, x72, x90, x13, x91, x93, x94, x75, x96, x77, x30, x39, x99, x78, x100, x31, x101, x103, x104, x82, x105, x29, x106, x108, x109, x87, x110, x24, x111, x113, x114, x92, x115, x16, x116, x118, x119, x95, x120, x8, x121, x123, x124, x97, x36, x98, x127, x102, x128, x34, x129, x131, x132, x107, x133, x32, x134, x136, x137, x112, x138, x27, x139, x141, x142, x117, x143, x19, x144, x146, x147, x122, x148, x11, x149, x151, x152, x125, x150, x145, x140, x156, x126, x161, x130, x162, x154, x163, x165, x166, x135, x168, x167, x169, x171, x153, x172, x173, x158, x38, x176, x160, x177, x159, x178, x180, x181, x164, x182, x157, x183, x185, x186, x170, x187, x155, x188, x190, x191, x174, x192, x193, x175, x195, x179, x197, x184, x199, x189, x201, x202, x194, x204, x196, x206, x198, x208, x200, x203, x205, x207, x209, x210, x211, x212, x213;
  x0 = _br2_load((in0)+((uintptr_t)0ULL), sizeof(uintptr_t));
  x1 = _br2_load((in0)+((uintptr_t)8ULL), sizeof(uintptr_t));
  x2 = _br2_load((in0)+((uintptr_t)16ULL), sizeof(uintptr_t));
  x3 = _br2_load((in0)+((uintptr_t)24ULL), sizeof(uintptr_t));
  /*skip*/
  x4 = _br2_load((in1)+((uintptr_t)0ULL), sizeof(uintptr_t));
  x5 = _br2_load((in1)+((uintptr_t)8ULL), sizeof(uintptr_t));
  x6 = _br2_load((in1)+((uintptr_t)16ULL), sizeof(uintptr_t));
  x7 = _br2_load((in1)+((uintptr_t)24ULL), sizeof(uintptr_t));
  /*skip*/
  /*skip*/
  x8 = (x3)*(x7);
  x9 = _br2_mulhuu((x3), (x7));
  x10 = (x3)*(x6);
  x11 = _br2_mulhuu((x3), (x6));
  x12 = (x3)*(x5);
  x13 = _br2_mulhuu((x3), (x5));
  x14 = (x3)*(x4);
  x15 = _br2_mulhuu((x3), (x4));
  x16 = (x2)*(x7);
  x17 = _br2_mulhuu((x2), (x7));
  x18 = (x2)*(x6);
  x19 = _br2_mulhuu((x2), (x6));
  x20 = (x2)*(x5);
  x21 = _br2_mulhuu((x2), (x5));
  x22 = (x2)*(x4);
  x23 = _br2_mulhuu((x2), (x4));
  x24 = (x1)*(x7);
  x25 = _br2_mulhuu((x1), (x7));
  x26 = (x1)*(x6);
  x27 = _br2_mulhuu((x1), (x6));
  x28 = (x1)*(x5);
  x29 = _br2_mulhuu((x1), (x5));
  x30 = (x1)*(x4);
  x31 = _br2_mulhuu((x1), (x4));
  x32 = (x0)*(x7);
  x33 = _br2_mulhuu((x0), (x7));
  x34 = (x0)*(x6);
  x35 = _br2_mulhuu((x0), (x6));
  x36 = (x0)*(x5);
  x37 = _br2_mulhuu((x0), (x5));
  x38 = (x0)*(x4);
  x39 = _br2_mulhuu((x0), (x4));
  x40 = (x35)+(x14);
  x41 = (uintptr_t)((x40)<(x35));
  x42 = (x41)+(x33);
  x43 = (uintptr_t)((x42)<(x33));
  x44 = (x42)+(x12);
  x45 = (uintptr_t)((x44)<(x12));
  x46 = (x43)+(x45);
  x47 = (x46)+(x25);
  x48 = (x40)+(x20);
  x49 = (uintptr_t)((x48)<(x40));
  x50 = (x49)+(x44);
  x51 = (uintptr_t)((x50)<(x44));
  x52 = (x50)+(x15);
  x53 = (uintptr_t)((x52)<(x15));
  x54 = (x51)+(x53);
  x55 = (x54)+(x47);
  x56 = (uintptr_t)((x55)<(x47));
  x57 = (x56)+(x17);
  x58 = (x37)+(x22);
  x59 = (uintptr_t)((x58)<(x37));
  x60 = (x59)+(x48);
  x61 = (uintptr_t)((x60)<(x48));
  x62 = (x60)+(x23);
  x63 = (uintptr_t)((x62)<(x23));
  x64 = (x61)+(x63);
  x65 = (x64)+(x52);
  x66 = (uintptr_t)((x65)<(x52));
  x67 = (x65)+(x18);
  x68 = (uintptr_t)((x67)<(x18));
  x69 = (x66)+(x68);
  x70 = (x69)+(x55);
  x71 = (uintptr_t)((x70)<(x55));
  x72 = (x70)+(x10);
  x73 = (uintptr_t)((x72)<(x10));
  x74 = (x71)+(x73);
  x75 = (x74)+(x57);
  x76 = (uintptr_t)((x75)<(x57));
  x77 = (x76)+(x9);
  x78 = (x58)+(x28);
  x79 = (uintptr_t)((x78)<(x58));
  x80 = (x79)+(x62);
  x81 = (uintptr_t)((x80)<(x62));
  x82 = (x80)+(x26);
  x83 = (uintptr_t)((x82)<(x26));
  x84 = (x81)+(x83);
  x85 = (x84)+(x67);
  x86 = (uintptr_t)((x85)<(x67));
  x87 = (x85)+(x21);
  x88 = (uintptr_t)((x87)<(x21));
  x89 = (x86)+(x88);
  x90 = (x89)+(x72);
  x91 = (uintptr_t)((x90)<(x72));
  x92 = (x90)+(x13);
  x93 = (uintptr_t)((x92)<(x13));
  x94 = (x91)+(x93);
  x95 = (x94)+(x75);
  x96 = (uintptr_t)((x95)<(x75));
  x97 = (x96)+(x77);
  x98 = (x39)+(x30);
  x99 = (uintptr_t)((x98)<(x39));
  x100 = (x99)+(x78);
  x101 = (uintptr_t)((x100)<(x78));
  x102 = (x100)+(x31);
  x103 = (uintptr_t)((x102)<(x31));
  x104 = (x101)+(x103);
  x105 = (x104)+(x82);
  x106 = (uintptr_t)((x105)<(x82));
  x107 = (x105)+(x29);
  x108 = (uintptr_t)((x107)<(x29));
  x109 = (x106)+(x108);
  x110 = (x109)+(x87);
  x111 = (uintptr_t)((x110)<(x87));
  x112 = (x110)+(x24);
  x113 = (uintptr_t)((x112)<(x24));
  x114 = (x111)+(x113);
  x115 = (x114)+(x92);
  x116 = (uintptr_t)((x115)<(x92));
  x117 = (x115)+(x16);
  x118 = (uintptr_t)((x117)<(x16));
  x119 = (x116)+(x118);
  x120 = (x119)+(x95);
  x121 = (uintptr_t)((x120)<(x95));
  x122 = (x120)+(x8);
  x123 = (uintptr_t)((x122)<(x8));
  x124 = (x121)+(x123);
  x125 = (x124)+(x97);
  x126 = (x98)+(x36);
  x127 = (uintptr_t)((x126)<(x98));
  x128 = (x127)+(x102);
  x129 = (uintptr_t)((x128)<(x102));
  x130 = (x128)+(x34);
  x131 = (uintptr_t)((x130)<(x34));
  x132 = (x129)+(x131);
  x133 = (x132)+(x107);
  x134 = (uintptr_t)((x133)<(x107));
  x135 = (x133)+(x32);
  x136 = (uintptr_t)((x135)<(x32));
  x137 = (x134)+(x136);
  x138 = (x137)+(x112);
  x139 = (uintptr_t)((x138)<(x112));
  x140 = (x138)+(x27);
  x141 = (uintptr_t)((x140)<(x27));
  x142 = (x139)+(x141);
  x143 = (x142)+(x117);
  x144 = (uintptr_t)((x143)<(x117));
  x145 = (x143)+(x19);
  x146 = (uintptr_t)((x145)<(x19));
  x147 = (x144)+(x146);
  x148 = (x147)+(x122);
  x149 = (uintptr_t)((x148)<(x122));
  x150 = (x148)+(x11);
  x151 = (uintptr_t)((x150)<(x11));
  x152 = (x149)+(x151);
  x153 = (x152)+(x125);
  x154 = ((uintptr_t)38ULL)*(x150);
  x155 = _br2_mulhuu(((uintptr_t)38ULL), (x150));
  x156 = ((uintptr_t)38ULL)*(x145);
  x157 = _br2_mulhuu(((uintptr_t)38ULL), (x145));
  x158 = ((uintptr_t)38ULL)*(x140);
  x159 = _br2_mulhuu(((uintptr_t)38ULL), (x140));
  x160 = (x126)+(x156);
  x161 = (uintptr_t)((x160)<(x126));
  x162 = (x161)+(x130);
  x163 = (uintptr_t)((x162)<(x130));
  x164 = (x162)+(x154);
  x165 = (uintptr_t)((x164)<(x154));
  x166 = (x163)+(x165);
  x167 = ((uintptr_t)38ULL)*(x153);
  x168 = (x166)+(x135);
  x169 = (uintptr_t)((x168)<(x135));
  x170 = (x168)+(x167);
  x171 = (uintptr_t)((x170)<(x167));
  x172 = (x169)+(x171);
  x173 = _br2_mulhuu(((uintptr_t)38ULL), (x153));
  x174 = (x172)+(x173);
  x175 = (x38)+(x158);
  x176 = (uintptr_t)((x175)<(x38));
  x177 = (x176)+(x160);
  x178 = (uintptr_t)((x177)<(x160));
  x179 = (x177)+(x159);
  x180 = (uintptr_t)((x179)<(x159));
  x181 = (x178)+(x180);
  x182 = (x181)+(x164);
  x183 = (uintptr_t)((x182)<(x164));
  x184 = (x182)+(x157);
  x185 = (uintptr_t)((x184)<(x157));
  x186 = (x183)+(x185);
  x187 = (x186)+(x170);
  x188 = (uintptr_t)((x187)<(x170));
  x189 = (x187)+(x155);
  x190 = (uintptr_t)((x189)<(x155));
  x191 = (x188)+(x190);
  x192 = (x191)+(x174);
  x193 = ((uintptr_t)38ULL)*(x192);
  x194 = (x175)+(x193);
  x195 = (uintptr_t)((x194)<(x175));
  x196 = (x195)+(x179);
  x197 = (uintptr_t)((x196)<(x179));
  x198 = (x197)+(x184);
  x199 = (uintptr_t)((x198)<(x184));
  x200 = (x199)+(x189);
  x201 = (uintptr_t)((x200)<(x189));
  x202 = ((uintptr_t)38ULL)*(x201);
  x203 = (x194)+(x202);
  x204 = (uintptr_t)((x203)<(x194));
  x205 = (x204)+(x196);
  x206 = (uintptr_t)((x205)<(x196));
  x207 = (x206)+(x198);
  x208 = (uintptr_t)((x207)<(x198));
  x209 = (x208)+(x200);
  x210 = x203;
  x211 = x205;
  x212 = x207;
  x213 = x209;
  /*skip*/
  _br2_store((out0)+((uintptr_t)0ULL), x210, sizeof(uintptr_t));
  _br2_store((out0)+((uintptr_t)8ULL), x211, sizeof(uintptr_t));
  _br2_store((out0)+((uintptr_t)16ULL), x212, sizeof(uintptr_t));
  _br2_store((out0)+((uintptr_t)24ULL), x213, sizeof(uintptr_t));
  /*skip*/
  return;
}

/* NOTE: The following wrapper function is not covered by Coq proofs */
static void fiat_curve25519_solinas_mulmod(uint64_t out1[4], const uint64_t arg1[4], const uint64_t arg2[4]) {
  internal_fiat_curve25519_solinas_mulmod((uintptr_t)out1, (uintptr_t)arg1, (uintptr_t)arg2);
}
